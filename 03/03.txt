1.1 CREATE DATABASE census;
1.2 CREATE TABLE Ludzie( PESEL char(11) NOT NULL, imie varchar(30) NOT NULL, nazwisko varchar(30) NOT NULL, data_urodzenia date NOT NULL,plec enum('F', 'M') NOT NULL, PRIMARY KEY (PESEL));
1.3 CREATE TABLE Zawody( zawod_id int NOT NULL AUTO_INCREMENT, nazwa varchar(50) NOT NULL, pensja_min float NOT NULL, pensja_max float NOT NULL, PRIMARY KEY(zawod_id), CONSTRAINT minmax CHECK(pensja_min >= 0 and pensja_max >=0 and pensja_min < pensja_max));
1.4 CREATE TABLE Pracownicy (PESEL char(11) NOT NULL, zawod_id int NOT NULL, pensja float NOT NULL);
1.5 INSERT INTO ludzie VALUES  ... ze srciptu w pythonie
1.6 INSERT INTO zawody VALUES (1, "polityk", 6000.0, 25000.0), (2, "nauczyciel", 3200.51, 6210.2), (3, "lekarz", 4200.0, 20000.0), (4, "informatyk", 5000.0, 50000.0);
1.7 
DELIMITER //

CREATE PROCEDURE people_to_profession()
BEGIN
  DECLARE done INT DEFAULT FALSE;
  DECLARE psl char(11);
  DECLARE birth_date date;
  DECLARE gender enum('F', 'M');
  DECLARE proff_id int;
  DECLARE earn float;
  DECLARE cur_ludzie CURSOR FOR SELECT PESEL, data_urodzenia, plec FROM ludzie;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

  OPEN cur_ludzie;

  gen_loop: LOOP
    FETCH cur_ludzie INTO psl, birth_date, gender;

    IF done THEN
      LEAVE gen_loop;
    END IF;

    fetch_proffesion: LOOP
      proff_id = FLOOR(1 + RAND()*4)
    IF proff_id <> 3 THEN
      LEAVE gen_loop;
    ELSEIF gender = "M" THEN
      IF TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) <= 65 THEN
        LEAVE fetch_proffesion;
      END IF;
    ELSE
      IF TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) <= 06 THEN
        LEAVE fetch_proffesion;
      END IF;
    END IF;

    earn = # CALCULATE EARNINGS

    INSERT INTO pracownicy VALUES (psl, proff_id, earn);
    END LOOP;
  END LOOP;

  CLOSE cur_ludzie;
END; //

DELIMITER ;
